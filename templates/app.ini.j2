# Configuration file for Forgejo
# Generated by Ansible role

[repository]
ROOT = {{ forgejo_repository_root }}
DEFAULT_PRIVATE = {{ forgejo_repository_default_private }}
DEFAULT_BRANCH = {{ forgejo_repository_default_branch }}
DISABLE_HTTP_GIT = {{ forgejo_repository_disable_http_git | lower }}

[repository.local]
LOCAL_COPY_PATH = {{ forgejo_data_path }}/tmp/local-repo

[repository.upload]
TEMP_PATH = {{ forgejo_data_path }}/uploads
FILE_MAX_SIZE = {{ forgejo_repository_upload_file_max_size }}
MAX_FILES = {{ forgejo_repository_upload_max_files }}

[server]
PROTOCOL = {{ forgejo_server_protocol }}
DOMAIN = {{ forgejo_server_domain }}
HTTP_ADDR = {{ forgejo_server_http_addr }}
HTTP_PORT = {{ forgejo_server_http_port }}
ROOT_URL = {{ forgejo_server_root_url }}
DISABLE_SSH = {{ forgejo_server_disable_ssh | lower }}
{% if not forgejo_server_disable_ssh %}
SSH_DOMAIN = {{ forgejo_server_ssh_domain }}
SSH_PORT = {{ forgejo_server_ssh_port }}
SSH_LISTEN_PORT = {{ forgejo_server_ssh_listen_port }}
OFFLINE_MODE = false
{% endif %}
LFS_START_SERVER = {{ forgejo_server_lfs_start_server | lower }}
APP_DATA_PATH = {{ forgejo_data_path }}
ENABLE_GZIP = {{ forgejo_server_enable_gzip | lower }}
LANDING_PAGE = {{ forgejo_server_landing_page }}

[database]
DB_TYPE = {{ forgejo_database_type }}
{% if forgejo_database_type == 'sqlite3' %}
PATH = {{ forgejo_database_path }}
{% else %}
HOST = {{ forgejo_database_host }}:{{ forgejo_database_port }}
NAME = {{ forgejo_database_name }}
USER = {{ forgejo_database_user }}
PASSWD = {{ forgejo_database_password }}
SSL_MODE = {{ forgejo_database_ssl_mode }}
{% endif %}

[security]
INSTALL_LOCK = {{ forgejo_security_install_lock | lower }}
SECRET_KEY = {{ forgejo_security_secret_key }}
INTERNAL_TOKEN = {{ forgejo_security_internal_token }}
MIN_PASSWORD_LENGTH = {{ forgejo_security_min_password_length }}
DISABLE_GIT_HOOKS = {{ forgejo_security_disable_git_hooks | lower }}

[service]
DISABLE_REGISTRATION = {{ forgejo_service_disable_registration | lower }}
ALLOW_ONLY_EXTERNAL_REGISTRATION = false
REQUIRE_SIGNIN_VIEW = {{ forgejo_service_require_signin_view | lower }}
REGISTER_EMAIL_CONFIRM = {{ forgejo_service_register_email_confirm | lower }}
ENABLE_CAPTCHA = {{ forgejo_service_enable_captcha | lower }}
DEFAULT_USER_VISIBILITY = {{ forgejo_service_default_user_visibility }}
ENABLE_NOTIFY_MAIL = {{ forgejo_service_enable_notify_mail | lower }}
DEFAULT_KEEP_EMAIL_PRIVATE = {{ forgejo_service_default_keep_email_private | lower }}
DEFAULT_ALLOW_CREATE_ORGANIZATION = {{ forgejo_service_default_allow_create_organization | lower }}
DEFAULT_ENABLE_TIMETRACKING = {{ forgejo_service_default_enable_timetracking | lower }}
NO_REPLY_ADDRESS = {{ forgejo_service_no_reply_address }}

{% if forgejo_mailer_enabled %}
[mailer]
ENABLED = true
PROTOCOL = {{ forgejo_mailer_protocol }}
{% if forgejo_mailer_protocol == 'smtp' %}
SMTP_ADDR = {{ forgejo_mailer_smtp_addr }}
SMTP_PORT = {{ forgejo_mailer_smtp_port }}
USER = {{ forgejo_mailer_user }}
PASSWD = {{ forgejo_mailer_passwd }}
{% endif %}
FROM = {{ forgejo_mailer_from }}
{% endif %}

[cache]
ADAPTER = {{ forgejo_cache_adapter }}
{% if forgejo_cache_adapter != 'memory' %}
HOST = {{ forgejo_cache_host }}
{% endif %}
ITEM_TTL = {{ forgejo_cache_item_ttl }}

[session]
PROVIDER = {{ forgejo_session_provider }}
{% if forgejo_session_provider == 'file' %}
PROVIDER_CONFIG = {{ forgejo_data_path }}/sessions
{% else %}
PROVIDER_CONFIG = {{ forgejo_session_provider_config | default('') }}
{% endif %}
COOKIE_NAME = {{ forgejo_session_cookie_name }}
SESSION_LIFE_TIME = {{ forgejo_session_session_life_time }}
GC_INTERVAL = {{ forgejo_session_gc_interval }}
SAME_SITE = {{ forgejo_session_same_site }}

[picture]
AVATAR_UPLOAD_PATH = {{ forgejo_data_path }}/avatars
REPOSITORY_AVATAR_UPLOAD_PATH = {{ forgejo_data_path }}/repo-avatars
GRAVATAR_SOURCE = {{ forgejo_picture_gravatar_source }}
DISABLE_GRAVATAR = {{ forgejo_picture_disable_gravatar | lower }}
ENABLE_FEDERATED_AVATAR = {{ forgejo_picture_enable_federated_avatar | lower }}

[attachment]
ENABLED = {{ forgejo_attachment_enabled | lower }}
PATH = {{ forgejo_data_path }}/attachments
ALLOWED_TYPES = {{ forgejo_attachment_allowed_types }}
MAX_SIZE = {{ forgejo_attachment_max_size }}
MAX_FILES = {{ forgejo_attachment_max_files }}

[log]
MODE = {{ forgejo_log_mode }}
ROOT_PATH = {{ forgejo_data_path }}/log
LEVEL = {{ forgejo_log_level }}
ROUTER = {{ forgejo_log_router }}
ENABLE_ACCESS_LOG = {{ forgejo_log_enable_access_log | lower }}
{% if forgejo_log_enable_access_log and forgejo_log_access_log_template %}
ACCESS_LOG_TEMPLATE = {{ forgejo_log_access_log_template }}
{% endif %}

[git.timeout]
DEFAULT = {{ forgejo_git_timeout_default }}
MIGRATE = {{ forgejo_git_timeout_migrate }}
MIRROR = {{ forgejo_git_timeout_mirror }}
CLONE = {{ forgejo_git_timeout_clone }}
PULL = {{ forgejo_git_timeout_pull }}
GC = {{ forgejo_git_timeout_gc }}